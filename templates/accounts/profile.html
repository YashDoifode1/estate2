{% extends 'base.html' %}

{% block title %}
{{ user.get_full_name }} | DreamHomes Realty Profile
{% endblock %}

{% block content %}
    <!-- Profile Header -->
    <section class="profile-header bg-blue-900 text-white pt-8 pb-16">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row items-center">
                <!-- Profile Picture -->
                <div class="mb-6 md:mb-0 md:mr-8" data-aos="fade-right">
                    <div class="relative">
                        <img src="{% if user.profile_picture %}{{ user.profile_picture.url }}{% else %}https://randomuser.me/api/portraits/men/75.jpg{% endif %}" 
                             alt="{{ user.get_full_name }}" class="w-32 h-32 rounded-full profile-pic">
                        <form id="profile-pic-form" method="POST" action="{% url 'upload_profile_picture' %}" enctype="multipart/form-data">
                            {% csrf_token %}
                            <input type="file" id="profile-pic-input" name="profile_picture" class="hidden" accept="image/*">
                            <button type="button" id="profile-pic-button" class="absolute bottom-2 right-2 bg-yellow-600 hover:bg-yellow-700 text-white p-2 rounded-full transition">
                                <i class="fas fa-camera text-sm"></i>
                            </button>
                        </form>
                    </div>
                </div>
                
                <!-- Profile Info -->
                <div class="flex-1 text-center md:text-left" data-aos="fade-left">
                    <h1 class="text-3xl font-bold mb-2">{{ user.get_full_name }}</h1>
                    <p class="text-blue-200 mb-4">Member since {{ user.date_joined|date:"F Y" }}</p>
                    
                    <div class="flex flex-wrap justify-center md:justify-start gap-6 mb-6">
                        <div class="flex items-center">
                            <i class="fas fa-envelope mr-2 text-yellow-400"></i>
                            <span>{{ user.email }}</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-phone mr-2 text-yellow-400"></i>
                            <span>{{ user.profile.phone_number|default:"Not provided" }}</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-map-marker-alt mr-2 text-yellow-400"></i>
                            <span>{{ user.profile.location|default:"Not provided" }}</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-info-circle mr-2 text-yellow-400"></i>
                            <span>{{ user.profile.bio|default:"No bio provided" }}</span>
                        </div>
                    </div>
                    
                    <div class="flex flex-wrap gap-4 justify-center md:justify-start">
                        <a href="{% url 'settings' %}" class="bg-white text-blue-900 hover:bg-blue-50 font-semibold py-2 px-6 rounded-lg transition flex items-center">
                            <i class="fas fa-edit mr-2"></i> Edit Profile
                        </a>
                        <button id="share-profile-btn" class="bg-transparent border border-white hover:bg-white hover:text-blue-900 font-semibold py-2 px-6 rounded-lg transition flex items-center">
                            <i class="fas fa-share-alt mr-2"></i> Share Profile
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="py-8 -mt-8">
        <div class="container mx-auto px-4">
            <!-- Tab Navigation -->
            <div class="bg-white rounded-t-lg shadow-sm" data-aos="fade-up">
                <div class="flex overflow-x-auto">
                    <button class="tab-button active" data-tab="saved-properties">
                        <i class="fas fa-heart mr-2"></i> Saved Properties
                        <span class="ml-2 bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">{{ saved_properties.count }}</span>
                    </button>
                    <button class="tab-button" data-tab="consultations">
                        <i class="fas fa-calendar-alt mr-2"></i> My Consultations
                        <span class="ml-2 bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">{{ consultations.count }}</span>
                    </button>
                    <button class="tab-button" data-tab="notifications">
                        <i class="fas fa-bell mr-2"></i> Notifications
                        <span class="ml-2 bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">{{ notifications.count }}</span>
                    </button>
                    <button class="tab-button" data-tab="preferences">
                        <i class="fas fa-sliders-h mr-2"></i> Preferences
                    </button>
                    <button class="tab-button" data-tab="sessions">
                        <i class="fas fa-desktop mr-2"></i> Active Sessions
                        <span class="ml-2 bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">{{ sessions.count }}</span>
                    </button>
                </div>
            </div>
            
            <!-- Tab Content -->
            <div class="bg-white rounded-b-lg shadow-md">
                <!-- Saved Properties Tab -->
                <div id="saved-properties" class="tab-content p-6 active">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-blue-900">Saved Properties</h2>
                        <div class="flex space-x-2">
                            <button class="bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 px-4 rounded-lg transition flex items-center">
                                <i class="fas fa-filter mr-2"></i> Filter
                            </button>
                            <button class="bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 px-4 rounded-lg transition flex items-center">
                                <i class="fas fa-sort mr-2"></i> Sort
                            </button>
                        </div>
                    </div>
                    
                    <!-- Properties Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        {% for saved_property in saved_properties %}
                            <div class="property-card bg-white rounded-lg overflow-hidden border" data-property-id="{{ saved_property.property.id }}">
                                <div class="relative">
                                    <img src="{{ saved_property.property.image.url|default:'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80' }}" 
                                         alt="{{ saved_property.property.title }}" class="w-full h-48 object-cover">
                                    <button class="toggle-save-btn absolute top-3 right-3 bg-white hover:bg-red-500 text-red-500 hover:text-white p-2 rounded-full transition">
                                        <i class="fas fa-heart"></i>
                                    </button>
                                    <div class="absolute top-3 left-3 bg-{% if saved_property.property.status == 'for_sale' %}yellow{% else %}green{% endif %}-600 text-white px-2 py-1 rounded text-sm font-semibold">
                                        {{ saved_property.property.status|title }}
                                    </div>
                                </div>
                                <div class="p-4">
                                    <h3 class="font-bold text-blue-900 mb-1">{{ saved_property.property.title }}</h3>
                                    <p class="text-gray-600 text-sm mb-3 flex items-center">
                                        <i class="fas fa-map-marker-alt text-yellow-600 mr-1"></i> {{ saved_property.property.location }}
                                    </p>
                                    <div class="flex justify-between text-gray-700 text-sm mb-3">
                                        <div class="flex items-center">
                                            <i class="fas fa-bed text-yellow-600 mr-1"></i> {{ saved_property.property.bedrooms }} Beds
                                        </div>
                                        <div class="flex items-center">
                                            <i class="fas fa-bath text-yellow-600 mr-1"></i> {{ saved_property.property.bathrooms }} Baths
                                        </div>
                                        <div class="flex items-center">
                                            <i class="fas fa-vector-square text-yellow-600 mr-1"></i> {{ saved_property.property.area }} sq.ft.
                                        </div>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <p class="text-xl font-bold text-blue-900">{{ saved_property.property.price }}</p>
                                        <div class="flex space-x-2">
                                            <a href="{% url 'property_detail' saved_property.property.id %}" class="bg-blue-900 hover:bg-blue-800 text-white px-3 py-1 rounded text-sm transition">
                                                View
                                            </a>
                                            <button class="remove-property-btn bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm transition">
                                                Remove
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% empty %}
                            <div class="empty-state text-center">
                                <i class="fas fa-heart text-4xl text-gray-400 mb-4"></i>
                                <h3 class="text-xl font-bold text-gray-700 mb-2">No Saved Properties</h3>
                                <p class="mb-6">You haven't saved any properties yet.</p>
                                <a href="{% url 'properties:property_list' %}" class="bg-blue-900 hover:bg-blue-800 text-white font-semibold py-2 px-6 rounded-lg transition inline-block">
                                    Browse Properties
                                </a>
                            </div>
                        {% endfor %}
                    </div>
                </div>
                
                <!-- Consultations Tab -->
                <div id="consultations" class="tab-content p-6 hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-blue-900">My Consultations</h2>
                        
                    </div>
                    
                    <!-- Consultations List -->
                    <div class="space-y-6">
                        {% for consultation in consultations %}
                            <div class="bg-white border rounded-lg p-6" data-aos="fade-up" data-consultation-id="{{ consultation.id }}">
                                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                                    <div class="mb-4 md:mb-0">
                                        <div class="flex items-center mb-2">
                                            <h3 class="text-lg font-bold text-blue-900 mr-4">{{ consultation.title }}</h3>
                                            <span class="status-badge status-{{ consultation.status }}">{{ consultation.status|title }}</span>
                                        </div>
                                        <div class="flex flex-wrap gap-4 text-gray-600">
                                            <div class="flex items-center">
                                                <i class="fas fa-user mr-2 text-yellow-600"></i>
                                                <span>With: {{ consultation.agent.get_full_name }}</span>
                                            </div>
                                            <div class="flex items-center">
                                                <i class="fas fa-calendar mr-2 text-yellow-600"></i>
                                                <span>{{ consultation.date|date:"F j, Y" }}</span>
                                            </div>
                                            <div class="flex items-center">
                                                <i class="fas fa-clock mr-2 text-yellow-600"></i>
                                                <span>{{ consultation.time|time:"h:i A" }} - {{ consultation.end_time|time:"h:i A" }}</span>
                                            </div>
                                            <div class="flex items-center">
                                                <i class="fas fa-{{ consultation.mode|lower }} mr-2 text-yellow-600"></i>
                                                <span>{{ consultation.mode|title }}</span>
                                            </div>
                                        </div>
                                        {% if consultation.notes %}
                                            <p class="text-gray-600 mt-2">{{ consultation.notes|truncatewords:20 }}</p>
                                        {% endif %}
                                    </div>
                                    <div class="flex space-x-2">
                                        {% if consultation.status == 'scheduled' or consultation.status == 'cancelled' %}
                                            <a href="{% url 'reschedule_consultation' consultation.id %}" class="bg-blue-900 hover:bg-blue-800 text-white px-4 py-2 rounded-lg transition text-sm">
                                                <i class="fas fa-{% if consultation.status == 'scheduled' %}edit{% else %}redo{% endif %} mr-1"></i> {{ consultation.status|title }}
                                            </a>
                                        {% endif %}
                                        {% if consultation.status == 'completed' %}
                                            <a href="{% url 'book_consultation' %}" class="bg-blue-900 hover:bg-blue-800 text-white px-4 py-2 rounded-lg transition text-sm">
                                                <i class="fas fa-redo mr-1"></i> Book Again
                                            </a>
                                            <a href="{% url 'consultation_details' consultation.id %}" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg transition text-sm">
                                                <i class="fas fa-file-alt mr-1"></i> Details
                                            </a>
                                        {% endif %}
                                        {% if consultation.status == 'scheduled' %}
                                            <button class="cancel-consultation-btn bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg transition text-sm">
                                                <i class="fas fa-times mr-1"></i> Cancel
                                            </button>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        {% empty %}
                            <div class="empty-state text-center">
                                <i class="fas fa-calendar-alt text-4xl text-gray-400 mb-4"></i>
                                <h3 class="text-xl font-bold text-gray-700 mb-2">No Consultations Booked</h3>
                                <p class="mb-6">You haven't booked any consultations yet.</p>
                                
                            </div>
                        {% endfor %}
                    </div>
                </div>
                
                <!-- Notifications Tab -->
                <div id="notifications" class="tab-content p-6 hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-blue-900">Notifications</h2>
                        
                    </div>
                    
                    <!-- Notifications List -->
                    <div class="space-y-4">
                        {% for notification in notifications %}
                            <div class="bg-{% if notification.type == 'price_drop' %}blue-50 border-blue-200{% elif notification.type == 'consultation_reminder' %}green-50 border-green-200{% else %}yellow-50 border-yellow-200{% endif %} border rounded-lg p-4" data-aos="fade-up" data-notification-id="{{ notification.id }}">
                                <div class="flex">
                                    <div class="flex-shrink-0 mr-4">
                                        <div class="w-10 h-10 bg-{% if notification.type == 'price_drop' %}blue{% elif notification.type == 'consultation_reminder' %}green{% else %}yellow{% endif %}-100 rounded-full flex items-center justify-center">
                                            <i class="fas fa-{% if notification.type == 'price_drop' %}home{% elif notification.type == 'consultation_reminder' %}calendar-check{% else %}home{% endif %} text-{% if notification.type == 'price_drop' %}blue{% elif notification.type == 'consultation_reminder' %}green{% else %}yellow{% endif %}-600"></i>
                                        </div>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-bold text-blue-900">{{ notification.title }}</h4>
                                        <p class="text-gray-700 mb-2">{{ notification.message }}</p>
                                        <p class="text-gray-500 text-sm">{{ notification.created_at|timesince }} ago</p>
                                    </div>
                                    <button class="dismiss-notification-btn text-gray-400 hover:text-gray-600 self-start">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        {% empty %}
                            <div class="empty-state text-center">
                                <i class="fas fa-bell text-4xl text-gray-400 mb-4"></i>
                                <h3 class="text-xl font-bold text-gray-700 mb-2">No Notifications</h3>
                                <p class="mb-6">You don't have any notifications at the moment.</p>
                            </div>
                        {% endfor %}
                    </div>
                </div>
                
                <!-- Preferences Tab -->
                <div id="preferences" class="tab-content p-6 hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-blue-900">Preferences</h2>
                        <a href="{% url 'settings' %}" class="bg-blue-900 hover:bg-blue-800 text-white font-semibold py-2 px-4 rounded-lg transition flex items-center">
                            <i class="fas fa-edit mr-2"></i> Edit Preferences
                        </a>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white border rounded-lg p-6" data-aos="fade-up">
                            <h3 class="text-lg font-bold text-blue-900 mb-4">Property Interests</h3>
                            <ul class="text-gray-600 space-y-2">
                                <li><i class="fas fa-{% if user.preferences.interest_buying %}check{% else %}times{% endif %} mr-2 text-{% if user.preferences.interest_buying %}green{% else %}red{% endif %}-600"></i> Buying: {% if user.preferences.interest_buying %}Interested{% else %}Not Interested{% endif %}</li>
                                <li><i class="fas fa-{% if user.preferences.interest_renting %}check{% else %}times{% endif %} mr-2 text-{% if user.preferences.interest_renting %}green{% else %}red{% endif %}-600"></i> Renting: {% if user.preferences.interest_renting %}Interested{% else %}Not Interested{% endif %}</li>
                                <li><i class="fas fa-{% if user.preferences.interest_selling %}check{% else %}times{% endif %} mr-2 text-{% if user.preferences.interest_selling %}green{% else %}red{% endif %}-600"></i> Selling: {% if user.preferences.interest_selling %}Interested{% else %}Not Interested{% endif %}</li>
                                <li><i class="fas fa-{% if user.preferences.interest_commercial %}check{% else %}times{% endif %} mr-2 text-{% if user.preferences.interest_commercial %}green{% else %}red{% endif %}-600"></i> Commercial: {% if user.preferences.interest_commercial %}Interested{% else %}Not Interested{% endif %}</li>
                            </ul>
                        </div>
                        <div class="bg-white border rounded-lg p-6" data-aos="fade-up">
                            <h3 class="text-lg font-bold text-blue-900 mb-4">Budget</h3>
                            <p class="text-gray-600">Minimum: {% if user.preferences.min_budget %}{{ user.preferences.min_budget|floatformat:2 }}{% else %}Not specified{% endif %}</p>
                            <p class="text-gray-600">Maximum: {% if user.preferences.max_budget %}{{ user.preferences.max_budget|floatformat:2 }}{% else %}Not specified{% endif %}</p>
                        </div>
                        <div class="bg-white border rounded-lg p-6" data-aos="fade-up">
                            <h3 class="text-lg font-bold text-blue-900 mb-4">Preferred Locations</h3>
                            {% if user.preferences.preferred_locations %}
                                <ul class="text-gray-600 space-y-2">
                                    {% for location in user.preferences.preferred_locations %}
                                        <li><i class="fas fa-map-marker-alt mr-2 text-yellow-600"></i> {{ location }}</li>
                                    {% endfor %}
                                </ul>
                            {% else %}
                                <p class="text-gray-600">No preferred locations specified.</p>
                            {% endif %}
                        </div>
                        <div class="bg-white border rounded-lg p-6" data-aos="fade-up">
                            <h3 class="text-lg font-bold text-blue-900 mb-4">Property Types</h3>
                            {% if user.preferences.property_types %}
                                <ul class="text-gray-600 space-y-2">
                                    {% for type in user.preferences.property_types %}
                                        <li><i class="fas fa-home mr-2 text-yellow-600"></i> {{ type }}</li>
                                    {% endfor %}
                                </ul>
                            {% else %}
                                <p class="text-gray-600">No property types specified.</p>
                            {% endif %}
                        </div>
                        <div class="bg-white border rounded-lg p-6" data-aos="fade-up">
                            <h3 class="text-lg font-bold text-blue-900 mb-4">Notification Settings</h3>
                            <ul class="text-gray-600 space-y-2">
                                <li><i class="fas fa-{% if user.notification_settings.email_property_recommendations %}check{% else %}times{% endif %} mr-2 text-{% if user.notification_settings.email_property_recommendations %}green{% else %}red{% endif %}-600"></i> Property Recommendations: {% if user.notification_settings.email_property_recommendations %}Enabled{% else %}Disabled{% endif %}</li>
                                <li><i class="fas fa-{% if user.notification_settings.email_price_drop_alerts %}check{% else %}times{% endif %} mr-2 text-{% if user.notification_settings.email_price_drop_alerts %}green{% else %}red{% endif %}-600"></i> Price Drop Alerts: {% if user.notification_settings.email_price_drop_alerts %}Enabled{% else %}Disabled{% endif %}</li>
                                <li><i class="fas fa-{% if user.notification_settings.email_new_listings %}check{% else %}times{% endif %} mr-2 text-{% if user.notification_settings.email_new_listings %}green{% else %}red{% endif %}-600"></i> New Listings: {% if user.notification_settings.email_new_listings %}Enabled{% else %}Disabled{% endif %}</li>
                                <li><i class="fas fa-{% if user.notification_settings.email_market_updates %}check{% else %}times{% endif %} mr-2 text-{% if user.notification_settings.email_market_updates %}green{% else %}red{% endif %}-600"></i> Market Updates: {% if user.notification_settings.email_market_updates %}Enabled{% else %}Disabled{% endif %}</li>
                                <li><i class="fas fa-{% if user.notification_settings.email_promotional_offers %}check{% else %}times{% endif %} mr-2 text-{% if user.notification_settings.email_promotional_offers %}green{% else %}red{% endif %}-600"></i> Promotional Offers: {% if user.notification_settings.email_promotional_offers %}Enabled{% else %}Disabled{% endif %}</li>
                                <li><i class="fas fa-{% if user.notification_settings.push_notifications %}check{% else %}times{% endif %} mr-2 text-{% if user.notification_settings.push_notifications %}green{% else %}red{% endif %}-600"></i> Push Notifications: {% if user.notification_settings.push_notifications %}Enabled{% else %}Disabled{% endif %}</li>
                                <li><i class="fas fa-{% if user.notification_settings.sms_notifications %}check{% else %}times{% endif %} mr-2 text-{% if user.notification_settings.sms_notifications %}green{% else %}red{% endif %}-600"></i> SMS Notifications: {% if user.notification_settings.sms_notifications %}Enabled{% else %}Disabled{% endif %}</li>
                            </ul>
                        </div>
                        <div class="bg-white border rounded-lg p-6" data-aos="fade-up">
                            <h3 class="text-lg font-bold text-blue-900 mb-4">Privacy Settings</h3>
                            <ul class="text-gray-600 space-y-2">
                                <li><i class="fas fa-{% if user.privacy_settings.data_sharing %}check{% else %}times{% endif %} mr-2 text-{% if user.privacy_settings.data_sharing %}green{% else %}red{% endif %}-600"></i> Data Sharing: {% if user.privacy_settings.data_sharing %}Enabled{% else %}Disabled{% endif %}</li>
                                <li><i class="fas fa-{% if user.privacy_settings.personalized_ads %}check{% else %}times{% endif %} mr-2 text-{% if user.privacy_settings.personalized_ads %}green{% else %}red{% endif %}-600"></i> Personalized Ads: {% if user.privacy_settings.personalized_ads %}Enabled{% else %}Disabled{% endif %}</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Active Sessions Tab -->
                <div id="sessions" class="tab-content p-6 hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-blue-900">Active Sessions</h2>
                        <button id="terminate-all-sessions" class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition flex items-center">
                            <i class="fas fa-sign-out-alt mr-2"></i> Terminate All
                        </button>
                    </div>
                    <div class="space-y-4">
                        {% for session in sessions %}
                            <div class="bg-white border rounded-lg p-4" data-aos="fade-up" data-session-id="{{ session.id }}">
                                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                                    <div class="mb-4 md:mb-0">
                                        <h4 class="font-bold text-blue-900">{{ session.device }}</h4>
                                        <p class="text-gray-600 text-sm">IP: {{ session.ip_address }}</p>
                                        <p class="text-gray-600 text-sm">Location: {{ session.location }}</p>
                                        <p class="text-gray-600 text-sm">Last Active: {{ session.last_active|timesince }} ago</p>
                                        <p class="text-gray-600 text-sm">User Agent: {{ session.user_agent|truncatechars:50 }}</p>
                                    </div>
                                    <button class="terminate-session-btn bg-red-100 hover:bg-red-200 text-red-700 px-4 py-2 rounded-lg transition text-sm">
                                        <i class="fas fa-times mr-1"></i> Terminate
                                    </button>
                                </div>
                            </div>
                        {% empty %}
                            <div class="empty-state text-center">
                                <i class="fas fa-desktop text-4xl text-gray-400 mb-4"></i>
                                <h3 class="text-xl font-bold text-gray-700 mb-2">No Active Sessions</h3>
                                <p class="mb-6">No active login sessions found.</p>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="py-16 bg-blue-900 text-white">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-3xl md:text-4xl font-bold mb-6" data-aos="fade-up">Need Help With Your Property Search?</h2>
            <p class="text-xl mb-10 max-w-2xl mx-auto" data-aos="fade-up" data-aos-delay="200">
                Our expert agents are here to help you find your dream home.
            </p>
            <div class="flex flex-col md:flex-row justify-center space-y-4 md:space-y-0 md:space-x-4" data-aos="fade-up" data-aos-delay="400">
                
                <a href="{% url 'properties:property_list' %}" class="bg-transparent border-2 border-white hover:bg-white hover:text-blue-900 text-white font-bold py-3 px-8 rounded-lg transition">
                    Browse Properties
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <!-- Company Info -->
                <div>
                    <div class="flex items-center mb-6">
                        <div class="w-10 h-10 bg-blue-900 rounded-full flex items-center justify-center mr-2">
                            <i class="fas fa-home text-white text-lg"></i>
                        </div>
                        <h2 class="text-2xl font-bold">DreamHomes <span class="text-yellow-600">Realty</span></h2>
                    </div>
                    <p class="text-gray-400 mb-6">
                        Your trusted partner for all real estate needs in Nagpur. We help you find, buy, rent, or sell properties with ease and confidence.
                    </p>
                    <div class="flex space-x-4">
                        <a href="{{ company.facebook_url|default:'#' }}" class="bg-gray-800 w-10 h-10 rounded-full flex items-center justify-center hover:bg-blue-900 transition">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="{{ company.twitter_url|default:'#' }}" class="bg-gray-800 w-10 h-10 rounded-full flex items-center justify-center hover:bg-blue-900 transition">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="{{ company.instagram_url|default:'#' }}" class="bg-gray-800 w-10 h-10 rounded-full flex items-center justify-center hover:bg-blue-900 transition">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="{{ company.linkedin_url|default:'#' }}" class="bg-gray-800 w-10 h-10 rounded-full flex items-center justify-center hover:bg-blue-900 transition">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                    </div>
                </div>
                
                <!-- Quick Links -->
                <div>
                    <h3 class="text-xl font-bold mb-6">Quick Links</h3>
                    <ul class="space-y-3">
                        <li><a href="{% url 'home' %}" class="text-gray-400 hover:text-yellow-600 transition">Home</a></li>
                        <li><a href="{% url 'properties:property_list' %}" class="text-gray-400 hover:text-yellow-600 transition">Properties</a></li>
                        <li><a href="{% url 'about' %}" class="text-gray-400 hover:text-yellow-600 transition">About Us</a></li>
                        <li><a href="{% url 'agents:agents_list' %}" class="text-gray-400 hover:text-yellow-600 transition">Our Agents</a></li>
                        <li><a href="{% url 'blog:blog_list' %}" class="text-gray-400 hover:text-yellow-600 transition">Blog</a></li>
                        <li><a href="{% url 'profile' %}" class="text-gray-400 hover:text-yellow-600 transition">My Profile</a></li>
                    </ul>
                </div>
                
                <!-- Contact Info -->
                <div>
                    <h3 class="text-xl font-bold mb-6">Contact Us</h3>
                    <ul class="space-y-4">
                        <li class="flex items-start">
                            <i class="fas fa-map-marker-alt text-yellow-600 mt-1 mr-3"></i>
                            <span class="text-gray-400">{{ company.address|default:"123 Civil Lines, Nagpur, Maharashtra 440001" }}</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-phone text-yellow-600 mr-3"></i>
                            <span class="text-gray-400">{{ company.phone|default:"+91 98765 43210" }}</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-envelope text-yellow-600 mr-3"></i>
                            <span class="text-gray-400">{{ company.email|default:"info@dreamhomesrealty.com" }}</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-clock text-yellow-600 mr-3"></i>
                            <span class="text-gray-400">{{ company.hours|default:"Mon - Sat: 9:00 AM - 7:00 PM" }}</span>
                        </li>
                    </ul>
                </div>
                
                <!-- Newsletter -->
                
            </div>
            
            <div class="border-t border-gray-800 mt-12 pt-8 text-center text-gray-400">
                <p>&copy; {{ now|date:"Y" }} DreamHomes Realty. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Custom JavaScript -->
    <script>
        // Initialize AOS
        AOS.init({
            duration: 1000,
            once: true,
            offset: 100
        });

        // Profile Picture Upload
        const profilePicButton = document.getElementById('profile-pic-button');
        const profilePicInput = document.getElementById('profile-pic-input');
        const profilePicForm = document.getElementById('profile-pic-form');

        profilePicButton.addEventListener('click', function() {
            profilePicInput.click();
        });

        profilePicInput.addEventListener('change', function() {
            if (this.files.length > 0) {
                profilePicForm.submit();
            }
        });

        // Share Profile
        document.getElementById('share-profile-btn').addEventListener('click', function() {
            const url = window.location.href;
            navigator.clipboard.writeText(url).then(() => {
                alert('Profile URL copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy URL:', err);
                alert('Failed to copy URL. Please try again.');
            });
        });

        // Tab Switching
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', function() {
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                    content.classList.add('hidden');
                });

                this.classList.add('active');
                const tabId = this.getAttribute('data-tab');
                document.getElementById(tabId).classList.remove('hidden');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Property Save/Unsave Toggle
        document.querySelectorAll('.toggle-save-btn').forEach(button => {
            button.addEventListener('click', function(e) {
                e.stopPropagation();
                const propertyId = this.closest('.property-card').getAttribute('data-property-id');
                const heart = this.querySelector('i');
                const isSaved = heart.classList.contains('fa-heart');

                fetch('{% url "toggle_save_property" %}', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': '{{ csrf_token }}'
                    },
                    body: JSON.stringify({ property_id: propertyId })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        if (isSaved) {
                            heart.classList.remove('fa-heart');
                            heart.classList.add('fa-heart-broken');
                            this.classList.remove('text-red-500', 'hover:bg-red-500');
                            this.classList.add('text-gray-400', 'hover:bg-gray-400');
                        } else {
                            heart.classList.remove('fa-heart-broken');
                            heart.classList.add('fa-heart');
                            this.classList.remove('text-gray-400', 'hover:bg-gray-400');
                            this.classList.add('text-red-500', 'hover:bg-red-500');
                        }
                        document.querySelector('[data-tab="saved-properties"] .bg-blue-100').textContent = data.saved_count;
                    } else {
                        alert(data.message || 'Failed to update save status.');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('An error occurred. Please try again.');
                });
            });
        });

        // Property Remove Button
        document.querySelectorAll('.remove-property-btn').forEach(button => {
            button.addEventListener('click', function(e) {
                e.stopPropagation();
                const propertyCard = this.closest('.property-card');
                const propertyId = propertyCard.getAttribute('data-property-id');

                fetch('{% url "remove_saved_property" %}', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': '{{ csrf_token }}'
                    },
                    body: JSON.stringify({ property_id: propertyId })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        propertyCard.style.opacity = '0';
                        propertyCard.style.transform = 'translateX(100px)';
                        setTimeout(() => {
                            propertyCard.remove();
                            const propertiesContainer = document.querySelector('#saved-properties .grid');
                            if (propertiesContainer.children.length === 0) {
                                document.querySelector('#saved-properties .empty-state').classList.remove('hidden');
                            }
                            document.querySelector('[data-tab="saved-properties"] .bg-blue-100').textContent = data.saved_count;
                        }, 300);
                    } else {
                        alert(data.message || 'Failed to remove property.');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('An error occurred. Please try again.');
                });
            });
        });

        // Close Notification
        document.querySelectorAll('.dismiss-notification-btn').forEach(button => {
            button.addEventListener('click', function() {
                const notification = this.closest('.bg-white, .bg-blue-50, .bg-yellow-50, .bg-green-50');
                const notificationId = notification.getAttribute('data-notification-id');

                fetch('{% url "dismiss_notification" %}', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': '{{ csrf_token }}'
                    },
                    body: JSON.stringify({ notification_id: notificationId })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        notification.style.opacity = '0';
                        notification.style.transform = 'translateX(100px)';
                        setTimeout(() => {
                            notification.remove();
                            const notificationsContainer = document.querySelector('#notifications .space-y-4');
                            if (notificationsContainer.children.length === 0) {
                                document.querySelector('#notifications .empty-state').classList.remove('hidden');
                            }
                            document.querySelector('[data-tab="notifications"] .bg-blue-100').textContent = data.notification_count;
                        }, 300);
                    } else {
                        alert(data.message || 'Failed to dismiss notification.');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('An error occurred. Please try again.');
                });
            });
        });

        // Cancel Consultation
        document.querySelectorAll('.cancel-consultation-btn').forEach(button => {
            button.addEventListener('click', function() {
                if (confirm('Are you sure you want to cancel this consultation?')) {
                    const consultation = this.closest('.bg-white');
                    const consultationId = consultation.getAttribute('data-consultation-id');

                    fetch('{% url "cancel_consultation" %}', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': '{{ csrf_token }}'
                        },
                        body: JSON.stringify({ consultation_id: consultationId })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            consultation.style.opacity = '0';
                            consultation.style.transform = 'translateX(100px)';
                            setTimeout(() => {
                                consultation.remove();
                                const consultationsContainer = document.querySelector('#consultations .space-y-6');
                                if (consultationsContainer.children.length === 0) {
                                    document.querySelector('#consultations .empty-state').classList.remove('hidden');
                                }
                                document.querySelector('[data-tab="consultations"] .bg-blue-100').textContent = data.consultation_count;
                            }, 300);
                        } else {
                            alert(data.message || 'Failed to cancel consultation.');
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        alert('An error occurred. Please try again.');
                    });
                }
            });
        });

        // Terminate Session
        document.querySelectorAll('.terminate-session-btn').forEach(button => {
            button.addEventListener('click', function() {
                if (confirm('Are you sure you want to terminate this session?')) {
                    const session = this.closest('.bg-white');
                    const sessionId = session.getAttribute('data-session-id');

                    fetch('{% url "terminate_session" %}', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': '{{ csrf_token }}'
                        },
                        body: JSON.stringify({ session_id: sessionId })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            session.style.opacity = '0';
                            session.style.transform = 'translateX(100px)';
                            setTimeout(() => {
                                session.remove();
                                const sessionsContainer = document.querySelector('#sessions .space-y-4');
                                if (sessionsContainer.children.length === 0) {
                                    document.querySelector('#sessions .empty-state').classList.remove('hidden');
                                }
                                document.querySelector('[data-tab="sessions"] .bg-blue-100').textContent = data.session_count;
                            }, 300);
                        } else {
                            alert(data.message || 'Failed to terminate session.');
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        alert('An error occurred. Please try again.');
                    });
                }
            });
        });

        // Terminate All Sessions
        document.getElementById('terminate-all-sessions').addEventListener('click', function() {
            if (confirm('Are you sure you want to terminate all sessions? This will log you out from all devices except the current one.')) {
                fetch('{% url "terminate_all_sessions" %}', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': '{{ csrf_token }}'
                    },
                    body: JSON.stringify({})
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const sessionsContainer = document.querySelector('#sessions .space-y-4');
                        sessionsContainer.innerHTML = '';
                        document.querySelector('#sessions .empty-state').classList.remove('hidden');
                        document.querySelector('[data-tab="sessions"] .bg-blue-100').textContent = data.session_count;
                        alert('All sessions terminated successfully.');
                    } else {
                        alert(data.message || 'Failed to terminate sessions.');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('An error occurred. Please try again.');
                });
            }
        });
    </script>
{% endblock %}